// ---- ‡∏•‡∏î log TF (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô tf import) ----
process.env.TF_CPP_MIN_LOG_LEVEL = process.env.TF_CPP_MIN_LOG_LEVEL || "2";

require("dotenv").config();
const express = require("express");
const axios = require("axios");
const bodyParser = require("body-parser");
const tf = require("@tensorflow/tfjs-node");
const sharp = require("sharp");
const fs = require("fs");
const path = require("path");
const dialogflow = require("@google-cloud/dialogflow");
const { google } = require("googleapis");

// --- sharp: ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏ç‡πà/EXIF ---
sharp.cache(true);
sharp.concurrency(1);

const app = express();
const PORT = process.env.PORT || 3000;
const LINE_ACCESS_TOKEN = process.env.LINE_ACCESS_TOKEN;

// ====== CONFIG (‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ default ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á ENV ‡∏Å‡πá‡πÑ‡∏î‡πâ) ======
const INPUT_SIZE = Number(process.env.INPUT_SIZE || 300);

// ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏£‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ Rescaling(1./255) ‡πÅ‡∏•‡πâ‡∏ß
const MODEL_INCLUDES_RESCALE = true;

// Unknown policy
const UNKNOWN_THRESHOLD = Number(process.env.UNKNOWN_THRESHOLD || 0.55);
const MARGIN_THRESHOLD = Number(process.env.MARGIN_THRESHOLD || 0.08);
const ENTROPY_THRESHOLD = Number(process.env.ENTROPY_THRESHOLD || 1.60);

// ‡∏ó‡∏≥ prob ‡πÉ‡∏´‡πâ‡∏Ñ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢ (‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à top-1 ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÇ‡∏≠‡πÄ‡∏ß‡∏≠‡∏£‡πå)
const PROB_SHARPEN_GAMMA = Number(process.env.PROB_SHARPEN_GAMMA || 1.36);

// per-class calibration (‡∏î‡∏±‡∏ô Eczema/Shingles ‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô)
function parseDictEnv(text) {
  const out = {};
  if (!text) return out;
  String(text)
    .split(",")
    .forEach((pair) => {
      const [k, v] = pair.split(":").map((s) => s.trim());
      if (k && v && !Number.isNaN(Number(v))) out[k] = Number(v);
    });
  return out;
}
let CALIB_WEIGHTS = parseDictEnv(process.env.CALIB_WEIGHTS);
let PER_CLASS_THRESHOLDS = parseDictEnv(process.env.PER_CLASS_THRESHOLDS);

// defaults ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á ENV
if (!Object.keys(CALIB_WEIGHTS).length) {
  CALIB_WEIGHTS = { Eczema: 1.55, Shingles: 1.45 };
}
if (!Object.keys(PER_CLASS_THRESHOLDS).length) {
  PER_CLASS_THRESHOLDS = { Eczema: 0.48, Shingles: 0.48 };
}

// ====== DISCLAIMER (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô ‡πÅ‡∏õ‡∏∞‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ info/care) ======
const DISCLAIMER = `‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô/‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÑ‡∏î‡πâ
‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á ‡∏ú‡∏∑‡πà‡∏ô‡∏•‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß ‡πÄ‡∏à‡πá‡∏ö‡∏õ‡∏ß‡∏î‡∏°‡∏≤‡∏Å ‡πÑ‡∏Ç‡πâ‡∏™‡∏π‡∏á ‡∏ú‡∏∑‡πà‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡∏ï‡∏≤/‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏±‡∏á‡∏ß‡∏•‡πÉ‡∏à‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô‡πÄ‡∏≠‡∏á
‡∏Ñ‡∏ß‡∏£‡πÑ‡∏õ‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏∞‡∏Ñ‡∏∞`;

// ====== Disease Info/Care mapping (‡πÑ‡∏°‡πà‡∏°‡∏µ DISCLAIMER ‡∏ù‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß) ======
const diseaseInfo = {
  Acne: {
    info: `"‡∏™‡∏¥‡∏ß" (Acne)
- ‡∏™‡∏¥‡∏ß‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏ï‡πà‡∏≠‡∏°‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô + ‡∏Å‡∏≤‡∏£‡∏≠‡∏∏‡∏î‡∏ï‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏π‡∏Ç‡∏∏‡∏°‡∏Ç‡∏ô + ‡πÄ‡∏ä‡∏∑‡πâ‡∏≠ P.acnes
- ‡∏°‡∏±‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤ ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å ‡∏´‡∏•‡∏±‡∏á
- ‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡∏ß‡∏≠‡∏∏‡∏î‡∏ï‡∏±‡∏ô (‡∏´‡∏±‡∏ß‡∏Ç‡∏≤‡∏ß/‡∏´‡∏±‡∏ß‡∏î‡∏≥) ‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡∏ß‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö (‡πÅ‡∏î‡∏á ‡∏´‡∏ô‡∏≠‡∏á ‡∏Å‡πâ‡∏≠‡∏ô‡∏•‡∏∂‡∏Å)`,
    care: `‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "‡∏™‡∏¥‡∏ß"
1) ‡∏•‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ö‡∏≤ ‡πÜ ‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏•‡∏µ‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏±‡∏î‡∏ñ‡∏π‡πÅ‡∏£‡∏á ‡πÜ
2) ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏µ‡∏ö ‡πÅ‡∏Å‡∏∞ ‡πÅ‡∏Å‡∏∞‡πÄ‡∏Å‡∏≤ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≠‡∏¢‡πÅ‡∏î‡∏á ‡∏£‡∏≠‡∏¢‡∏î‡∏≥ ‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏•‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏î‡πâ
3) ‡πÉ‡∏ä‡πâ‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏≠‡∏∏‡∏î‡∏ï‡∏±‡∏ô‡∏£‡∏π‡∏Ç‡∏∏‡∏°‡∏Ç‡∏ô (non-comedogenic) ‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏≥‡∏≠‡∏≤‡∏á/‡∏Ñ‡∏£‡∏µ‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏ô‡∏°‡∏≤‡∏Å
4) ‡∏ô‡∏≠‡∏ô‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏û‡∏≠ ‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏™‡∏¥‡∏ß
5) ‡∏´‡∏≤‡∏Å‡∏™‡∏¥‡∏ß‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡∏°‡∏≤‡∏Å ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πâ‡∏≠‡∏ô ‡πÄ‡∏à‡πá‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á ‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡∏ó‡∏≤/‡∏¢‡∏≤‡∏Å‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°

*‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏™‡∏¥‡∏ß‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å ‡πÄ‡∏à‡πá‡∏ö‡∏°‡∏≤‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏°‡∏µ‡πÅ‡∏ú‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏±‡∏î ‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡∏∞‡∏Ñ‡∏∞*`,
  },

  Bullous: {
    info: `"‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏û‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô" (Bullous)
- ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏£‡∏Ñ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ä‡∏±‡πâ‡∏ô‡∏ú‡∏¥‡∏ß
- ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏ï‡∏∂‡∏á‡πÉ‡∏™‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏û‡∏≠‡∏á‡∏ö‡∏ô‡∏ú‡∏¥‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏¥‡∏ß‡∏ó‡∏µ‡πà‡πÅ‡∏î‡∏á
- ‡∏°‡∏±‡∏Å‡∏û‡∏ö‡πÉ‡∏ô‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏≠‡∏≤‡∏¢‡∏∏‡πÄ‡∏Å‡∏¥‡∏ô 60 ‡∏õ‡∏µ
- ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡πâ‡∏≠‡∏û‡∏±‡∏ö ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡πâ‡∏≠‡∏á ‡∏ï‡πâ‡∏ô‡∏Ç‡∏≤ ‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡πÅ‡∏ú‡∏•‡πÉ‡∏ô‡∏õ‡∏≤‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏¢‡∏∑‡πà‡∏≠‡∏ö‡∏∏‡πÑ‡∏î‡πâ`,
    care: `‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ "‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏û‡∏≠‡∏á"
1) ‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏à‡∏≤‡∏∞/‡πÅ‡∏Å‡∏∞‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏≠‡∏á ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏ç‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏à‡πá‡∏ö‡∏°‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏£‡πÉ‡∏´‡πâ‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•
2) ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏£‡∏≠‡∏¢‡πÇ‡∏£‡∏Ñ ‡∏ã‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏´‡πâ‡∏á ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏µ‡∏¢‡∏î‡∏™‡∏µ
3) ‡∏´‡∏≤‡∏Å‡∏ï‡∏∏‡πà‡∏°‡πÅ‡∏ï‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ú‡∏•‡∏ñ‡∏•‡∏≠‡∏Å ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡πÅ‡∏ú‡∏•‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡πÅ‡∏•‡∏∞‡∏õ‡∏¥‡∏î‡πÅ‡∏ú‡∏•‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
4) ‡∏°‡∏±‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡∏ó‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡πÄ‡∏ï‡∏µ‡∏¢‡∏£‡∏≠‡∏¢‡∏î‡πå ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏≤‡∏Å‡∏î‡∏†‡∏π‡∏°‡∏¥/‡∏¢‡∏≤‡∏õ‡∏è‡∏¥‡∏ä‡∏µ‡∏ß‡∏ô‡∏∞ (‡∏ï‡∏≤‡∏°‡∏î‡∏∏‡∏•‡∏¢‡∏û‡∏¥‡∏ô‡∏¥‡∏à‡πÅ‡∏û‡∏ó‡∏¢‡πå)
5) ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏£‡∏Ñ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏°‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏î‡πÉ‡∏ô‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ ‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤

***‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡πá‡∏ß*** ‡∏´‡∏≤‡∏Å:
- ‡∏°‡∏µ‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏´‡∏•‡∏≤‡∏¢‡∏ó‡∏µ‡πà
- ‡πÄ‡∏à‡πá‡∏ö‡πÅ‡∏™‡∏ö‡∏°‡∏≤‡∏Å ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏´‡∏¥‡∏ô‡∏•‡∏≥‡∏ö‡∏≤‡∏Å
- ‡∏°‡∏µ‡πÑ‡∏Ç‡πâ ‡∏≠‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏•‡∏µ‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏£‡πà‡∏ß‡∏°‡∏î‡πâ‡∏ß‡∏¢`,
  },

  Chickenpox: {
    info: `"‡∏≠‡∏µ‡∏™‡∏∏‡∏Å‡∏≠‡∏µ‡πÉ‡∏™" (Chickenpox)
- ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏£‡∏Ñ‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÑ‡∏ß‡∏£‡∏±‡∏™ varicella ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÑ‡∏≠ ‡∏à‡∏≤‡∏° ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥
- ‡∏°‡∏µ‡∏£‡∏∞‡∏¢‡∏∞‡∏ü‡∏±‡∏Å‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 2‚Äì3 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
- ‡∏°‡∏±‡∏Å‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢‡πÑ‡∏Ç‡πâ‡∏ï‡πà‡∏≥/‡πÑ‡∏Ç‡πâ‡∏™‡∏π‡∏á ‡∏õ‡∏ß‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢ ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏ú‡∏∑‡πà‡∏ô‡πÅ‡∏î‡∏á ‚Üí ‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÉ‡∏™ ‚Üí ‡∏ï‡∏∏‡πà‡∏°‡∏Ç‡∏∏‡πà‡∏ô‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏´‡∏ô‡∏≠‡∏á ‚Üí ‡∏™‡∏∞‡πÄ‡∏Å‡πá‡∏î
- ‡∏ú‡∏∑‡πà‡∏ô‡∏°‡∏±‡∏Å‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ ‡∏•‡∏≥‡∏ï‡∏±‡∏ß ‡πÅ‡∏ú‡πà‡∏ô‡∏´‡∏•‡∏±‡∏á ‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏ï‡∏∏‡πà‡∏°‡πÉ‡∏ô‡∏õ‡∏≤‡∏Å`,
    care: `‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô "‡∏≠‡∏µ‡∏™‡∏∏‡∏Å‡∏≠‡∏µ‡πÉ‡∏™"
1) ‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏°‡∏≤‡∏Å ‡πÜ
2) ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡πÑ‡∏Ç‡πâ‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡∏û‡∏≤‡∏£‡∏≤‡πÄ‡∏ã‡∏ï‡∏≤‡∏°‡∏≠‡∏• *‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡πÅ‡∏≠‡∏™‡πÑ‡∏û‡∏£‡∏¥‡∏ô* ‡πÉ‡∏ô‡πÄ‡∏î‡πá‡∏Å
3) ‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏∞ ‡πÄ‡∏Å‡∏≤ ‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÅ‡∏ö‡∏Ñ‡∏ó‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡πÅ‡∏•‡∏∞‡∏•‡∏î‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏Å‡∏¥‡∏î‡πÅ‡∏ú‡∏•‡πÄ‡∏õ‡πá‡∏ô
4) ‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡∏•‡∏î‡∏Ñ‡∏±‡∏ô‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£
5) ‡πÅ‡∏¢‡∏Å‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏ú‡πâ‡∏≤‡πÄ‡∏ä‡πá‡∏î‡∏ï‡∏±‡∏ß ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤ ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô
6) ‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏£‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô/‡∏´‡∏¢‡∏∏‡∏î‡∏á‡∏≤‡∏ô‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏ï‡∏∏‡πà‡∏°‡∏à‡∏∞‡πÅ‡∏´‡πâ‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 6‚Äì7 ‡∏ß‡∏±‡∏ô)

***‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ*** ‡∏´‡∏≤‡∏Å:
- ‡∏°‡∏µ‡πÑ‡∏Ç‡πâ‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å ‡∏´‡∏ô‡∏≤‡∏ß‡∏™‡∏±‡πà‡∏ô ‡∏´‡∏≠‡∏ö ‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢ ‡∏ä‡∏±‡∏Å ‡∏ã‡∏∂‡∏°
- ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ç‡∏¥‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏£‡∏†‡πå
- ‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô‡∏ï‡πà‡∏≥ / ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á`,
  },

  Eczema: {
    info: `"‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö" (Eczema)
- ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÇ‡∏£‡∏Ñ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏ô‡πÄ‡∏î‡πà‡∏ô
- ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏™‡∏≤‡∏£‡∏£‡∏∞‡∏Ñ‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏∑‡∏≠‡∏á/‡∏™‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ (‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏ö‡∏π‡πà ‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå ‡πÇ‡∏•‡∏´‡∏∞ ‡∏ñ‡∏∏‡∏á‡∏°‡∏∑‡∏≠ ‡∏Ø‡∏•‡∏Ø)
  ‡πÅ‡∏•‡∏∞‡∏à‡∏≤‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡∏Å‡∏£‡∏£‡∏° ‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏∑‡πà‡∏ô ‡πÜ
- ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ú‡∏∑‡πà‡∏ô‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏¢‡∏∞:
  ‚Ä¢ ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏â‡∏µ‡∏¢‡∏ö‡∏û‡∏•‡∏±‡∏ô: ‡πÅ‡∏î‡∏á ‡∏ö‡∏ß‡∏° ‡∏°‡∏µ‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥ ‡πÉ‡∏™ ‡∏ä‡∏∑‡πâ‡∏ô ‡πÄ‡∏¢‡∏¥‡πâ‡∏° ‡∏Ñ‡∏±‡∏ô‡∏°‡∏≤‡∏Å
  ‚Ä¢ ‡∏£‡∏∞‡∏¢‡∏∞‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á: ‡πÅ‡∏î‡∏á ‡∏Ñ‡∏±‡∏ô ‡∏°‡∏µ‡∏Ç‡∏∏‡∏¢ ‡∏•‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏∑‡πâ‡∏ô
  ‚Ä¢ ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á: ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏≤‡∏´‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏≤ ‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡∏Ç‡∏µ‡∏î‡∏Ç‡πà‡∏ß‡∏ô`,
    care: `‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö/‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡∏µ‡∏°‡∏≤"
1) ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏≤/‡∏ñ‡∏π‡πÅ‡∏£‡∏á ‡πÜ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏à‡∏∞‡∏¢‡∏¥‡πà‡∏á‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡πÉ‡∏´‡πâ‡∏ú‡∏∑‡πà‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô
2) ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏¥‡πà‡∏á‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏™‡∏±‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏ö‡∏π‡πà‡πÅ‡∏£‡∏á ‡πÜ ‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏ã‡∏±‡∏Å‡∏ú‡πâ‡∏≤ ‡∏ú‡∏á‡∏ã‡∏±‡∏Å‡∏ü‡∏≠‡∏Å ‡πÇ‡∏•‡∏´‡∏∞ ‡∏ô‡πâ‡∏≥‡∏´‡∏≠‡∏° ‡∏ñ‡∏∏‡∏á‡∏°‡∏∑‡∏≠‡∏¢‡∏≤‡∏á ‡∏Ø‡∏•‡∏Ø
3) ‡πÉ‡∏ä‡πâ‡∏°‡∏≠‡∏¢‡∏™‡πå‡πÄ‡∏à‡∏≠‡πÑ‡∏£‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥ ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô ‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏ô‡πâ‡∏≥‡∏´‡∏≠‡∏° (fragrance-free)
4) ‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡∏ó‡∏≤‡∏™‡πÄ‡∏ï‡∏µ‡∏¢‡∏£‡∏≠‡∏¢‡∏î‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏£‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏ï‡∏≤‡∏°‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (‡∏Ñ‡∏ß‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÅ‡∏û‡∏ó‡∏¢‡πå)
5) ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏±‡∏ô‡∏°‡∏≤‡∏Å‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡πÅ‡∏Å‡πâ‡πÅ‡∏û‡πâ/‡πÅ‡∏Å‡πâ‡∏Ñ‡∏±‡∏ô‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏™‡∏±‡πà‡∏á
6) ‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏•‡πá‡∏ö‡πÉ‡∏´‡πâ‡∏™‡∏±‡πâ‡∏ô ‡∏•‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏≤‡πÅ‡∏£‡∏á ‡πÜ

***‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå*** ‡∏´‡∏≤‡∏Å:
- ‡∏ú‡∏∑‡πà‡∏ô‡∏•‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß ‡πÅ‡∏î‡∏á‡∏°‡∏≤‡∏Å ‡∏£‡πâ‡∏≠‡∏ô ‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡πÄ‡∏¢‡∏≠‡∏∞ ‡∏™‡∏á‡∏™‡∏±‡∏¢‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠
- ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏£‡∏µ‡∏°‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô
- ‡∏ú‡∏∑‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤ ‡∏£‡∏≠‡∏ö‡∏ï‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏±‡πà‡∏ß‡∏ï‡∏±‡∏ß`,
  },

  Psoriasis: {
    info: `"‡∏™‡∏∞‡πÄ‡∏Å‡πá‡∏î‡πÄ‡∏á‡∏¥‡∏ô" (Psoriasis)
- ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏£‡∏Ñ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô ‡∏°‡∏µ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡∏Å‡∏£‡∏£‡∏°‡∏£‡πà‡∏ß‡∏°
- ‡∏ú‡∏∑‡πà‡∏ô‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏∑‡πâ‡∏ô‡πÅ‡∏î‡∏á ‡∏Ç‡∏≠‡∏ö‡∏ä‡∏±‡∏î ‡∏°‡∏µ‡∏Ç‡∏∏‡∏¢/‡∏™‡∏∞‡πÄ‡∏Å‡πá‡∏î‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡πÄ‡∏á‡∏¥‡∏ô‡∏´‡∏ô‡∏≤‡∏õ‡∏Å‡∏Ñ‡∏•‡∏∏‡∏°
- ‡∏°‡∏±‡∏Å‡∏û‡∏ö‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≠‡∏®‡∏≠‡∏Å ‡πÄ‡∏Ç‡πà‡∏≤ ‡∏´‡∏•‡∏±‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏•‡πà‡∏≤‡∏á ‡∏´‡∏ô‡∏±‡∏á‡∏®‡∏µ‡∏£‡∏©‡∏∞ ‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πá‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡∏£‡πà‡∏ß‡∏°
- ‡∏ú‡∏∑‡πà‡∏ô‡πÄ‡∏õ‡πá‡∏ô ‡πÜ ‡∏´‡∏≤‡∏¢ ‡πÜ ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÇ‡∏£‡∏Ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠`,
    care: `‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "‡∏™‡∏∞‡πÄ‡∏Å‡πá‡∏î‡πÄ‡∏á‡∏¥‡∏ô"
1) ‡∏ó‡∏≤‡∏°‡∏≠‡∏¢‡∏™‡πå‡πÄ‡∏à‡∏≠‡πÑ‡∏£‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠ ‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏´‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏ú‡∏¥‡∏ß
2) ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏∞ ‡∏•‡∏≠‡∏Å ‡∏Ç‡∏π‡∏î‡∏™‡∏∞‡πÄ‡∏Å‡πá‡∏î‡πÄ‡∏≠‡∏á ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡∏≤‡∏à‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡πÉ‡∏´‡πâ‡∏ú‡∏∑‡πà‡∏ô‡πÄ‡∏´‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏° (Koebner phenomenon)
3) ‡∏•‡∏î‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î ‡∏Å‡∏≤‡∏£‡∏≠‡∏î‡∏ô‡∏≠‡∏ô ‡∏Å‡∏≤‡∏£‡∏î‡∏∑‡πà‡∏°‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå ‡∏Å‡∏≤‡∏£‡∏™‡∏π‡∏ö‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà
4) ‡∏¢‡∏≤‡∏ó‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡πÄ‡∏ï‡∏µ‡∏¢‡∏£‡∏≠‡∏¢‡∏î‡πå ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡∏î‡∏µ ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏∑‡πà‡∏ô ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á
5) ‡∏Å‡∏£‡∏ì‡∏µ‡∏ú‡∏∑‡πà‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏Å‡∏¥‡∏ô 10% ‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏ß ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡∏Å‡∏¥‡∏ô ‡∏¢‡∏≤‡∏â‡∏µ‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏â‡∏≤‡∏¢‡πÅ‡∏™‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏Ç‡∏≠‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå

***‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå*** ‡∏´‡∏≤‡∏Å:
- ‡∏ú‡∏∑‡πà‡∏ô‡∏•‡∏≤‡∏°‡∏°‡∏≤‡∏Å/‡∏ó‡∏±‡πà‡∏ß‡∏ï‡∏±‡∏ß
- ‡∏õ‡∏ß‡∏î‡∏Ç‡πâ‡∏≠ ‡∏Ç‡πâ‡∏≠‡∏ö‡∏ß‡∏° ‡∏Ç‡∏¢‡∏±‡∏ö‡∏•‡∏≥‡∏ö‡∏≤‡∏Å
- ‡∏ú‡∏¥‡∏ß‡πÅ‡∏î‡∏á‡∏•‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏ï‡∏±‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏ï‡∏±‡∏ß ‡∏°‡∏µ‡πÑ‡∏Ç‡πâ ‡∏´‡∏ô‡∏≤‡∏ß‡∏™‡∏±‡πà‡∏ô (‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏ß‡∏∞‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡πÑ‡∏î‡πâ)`,
  },

  Shingles: {
    info: `"‡∏á‡∏π‡∏™‡∏ß‡∏±‡∏î" (Shingles)
- ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÑ‡∏ß‡∏£‡∏±‡∏™ varicella-zoster ‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏≠‡∏µ‡∏™‡∏∏‡∏Å‡∏≠‡∏µ‡πÉ‡∏™‡∏ó‡∏µ‡πà‡πÅ‡∏ù‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏õ‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô‡∏≠‡πà‡∏≠‡∏ô‡∏•‡∏á ‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏ú‡∏∑‡πà‡∏ô‡πÅ‡∏î‡∏á‡πÅ‡∏•‡∏∞‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏° ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡πÅ‡∏ô‡∏ß‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó
- ‡∏°‡∏±‡∏Å‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏ß‡∏î‡πÅ‡∏™‡∏ö‡∏õ‡∏ß‡∏î‡∏£‡πâ‡∏≠‡∏ô/‡πÄ‡∏à‡πá‡∏ö‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡πÑ‡∏ü‡∏ä‡πá‡∏≠‡∏ï ‡∏ô‡∏≥‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ú‡∏∑‡πà‡∏ô
- ‡∏°‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÄ‡∏ä‡πà‡∏ô ‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏ö‡πÄ‡∏≠‡∏ß/‡∏•‡∏≥‡∏ï‡∏±‡∏ß ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡πâ‡∏≠‡∏á ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤`,
    care: `‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "‡∏á‡∏π‡∏™‡∏ß‡∏±‡∏î"
1) ‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 72 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡πÅ‡∏£‡∏Å ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏¢‡∏≤‡∏ï‡πâ‡∏≤‡∏ô‡πÑ‡∏ß‡∏£‡∏±‡∏™ (‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏ú‡∏∑‡πà‡∏ô‡∏´‡∏≤‡∏¢‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡∏∞‡∏•‡∏î‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏õ‡∏ß‡∏î‡∏õ‡∏•‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á)
2) ‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏à‡∏≤‡∏∞/‡πÅ‡∏Å‡∏∞‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏≠‡∏á ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á ‡∏ã‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏´‡πâ‡∏á
3) ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏ú‡πâ‡∏≤‡∏ä‡∏∏‡∏ö‡∏ô‡πâ‡∏≥‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÄ‡∏¢‡πá‡∏ô ‡πÜ ‡∏õ‡∏£‡∏∞‡∏Ñ‡∏ö‡∏ö‡∏£‡∏£‡πÄ‡∏ó‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏ß‡∏î‡πÅ‡∏™‡∏ö‡πÑ‡∏î‡πâ‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô
4) ‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡∏•‡∏î‡∏õ‡∏ß‡∏î‡∏ï‡∏≤‡∏°‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡∏•‡∏î‡∏õ‡∏ß‡∏î‡∏õ‡∏•‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó‡πÉ‡∏ô‡∏ö‡∏≤‡∏á‡∏£‡∏≤‡∏¢
5) ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡πÉ‡∏Å‡∏•‡πâ‡∏ä‡∏¥‡∏î‡∏Å‡∏±‡∏ö‡∏´‡∏ç‡∏¥‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏£‡∏†‡πå ‡∏ó‡∏≤‡∏£‡∏Å‡πÅ‡∏£‡∏Å‡πÄ‡∏Å‡∏¥‡∏î ‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô‡∏ö‡∏Å‡∏û‡∏£‡πà‡∏≠‡∏á

***‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏î‡πà‡∏ß‡∏ô/‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô*** ‡∏´‡∏≤‡∏Å:
- ‡∏ú‡∏∑‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤ ‡πÉ‡∏Å‡∏•‡πâ‡∏ï‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ô‡∏ï‡∏≤ (‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏ß‡∏á‡∏ï‡∏≤)
- ‡∏õ‡∏ß‡∏î‡∏°‡∏≤‡∏Å‡∏°‡∏≤‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡πÑ‡∏Ç‡πâ‡∏™‡∏π‡∏á ‡∏´‡∏ô‡∏≤‡∏ß‡∏™‡∏±‡πà‡∏ô
- ‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß/‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô‡∏ï‡πà‡∏≥`,
  },

  Warts: {
    info: `"‡∏´‡∏π‡∏î" (Warts)
- ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÑ‡∏ß‡∏£‡∏±‡∏™ Human Papillomavirus (HPV)
- ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏ô‡∏π‡∏ô/‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Ç‡πá‡∏á‡∏ö‡∏ô‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á ‡∏°‡∏±‡∏Å‡∏û‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏≠ ‡πÄ‡∏ó‡πâ‡∏≤ ‡πÄ‡∏Ç‡πà‡∏≤ ‡∏Ç‡πâ‡∏≠‡∏®‡∏≠‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å/‡πÄ‡∏™‡∏µ‡∏¢‡∏î‡∏™‡∏µ
- ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡πÑ‡∏°‡πà‡πÄ‡∏à‡πá‡∏ö ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÅ‡∏£‡∏á‡∏Å‡∏î ‡πÄ‡∏ä‡πà‡∏ô ‡∏ù‡πà‡∏≤‡πÄ‡∏ó‡πâ‡∏≤
- ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡∏¥‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÅ‡∏ú‡∏•‡∏ñ‡∏•‡∏≠‡∏Å`,
    care: `‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "‡∏´‡∏π‡∏î"
1) ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏∞ ‡∏Ç‡∏π‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏µ‡∏ö‡∏´‡∏π‡∏î‡πÄ‡∏≠‡∏á ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏°/‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°
2) ‡∏´‡∏≤‡∏Å‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡πâ‡∏≤ ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÉ‡∏™‡πà‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡∏∏‡πà‡∏°‡∏û‡∏≠‡∏î‡∏µ ‡πÑ‡∏°‡πà‡∏ö‡∏µ‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î‡∏à‡∏∏‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏ã‡πâ‡∏≥ ‡πÜ
3) ‡∏°‡∏µ‡∏ß‡∏¥‡∏ò‡∏µ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö ‡πÄ‡∏ä‡πà‡∏ô ‡∏¢‡∏≤‡∏ó‡∏≤‡∏Å‡∏£‡∏î‡∏ã‡∏≤‡∏•‡∏¥‡πÑ‡∏ã‡∏•‡∏¥‡∏Å ‡∏Å‡∏≤‡∏£‡∏à‡∏µ‡πâ‡πÑ‡∏≠‡πÄ‡∏¢‡πá‡∏ô (‡πÑ‡∏ô‡πÇ‡∏ï‡∏£‡πÄ‡∏à‡∏ô‡πÄ‡∏´‡∏•‡∏ß) ‡∏Å‡∏≤‡∏£‡∏à‡∏µ‡πâ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ ‡πÄ‡∏•‡πÄ‡∏ã‡∏≠‡∏£‡πå ‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î ‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î
4) ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Ç‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏°‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏µ‡∏î‡πÇ‡∏Å‡∏ô ‡∏Å‡∏£‡∏£‡πÑ‡∏Å‡∏£‡∏ï‡∏±‡∏î‡πÄ‡∏•‡πá‡∏ö
5) ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 2/3 ‡∏Ç‡∏≠‡∏á‡∏´‡∏π‡∏î‡∏≠‡∏≤‡∏à‡∏´‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 12‚Äì24 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡πÉ‡∏´‡πâ‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏π‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

***‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå*** ‡∏´‡∏≤‡∏Å:
- ‡∏´‡∏π‡∏î‡πÄ‡∏à‡πá‡∏ö‡∏°‡∏≤‡∏Å ‡πÄ‡∏î‡∏¥‡∏ô‡∏•‡∏≥‡∏ö‡∏≤‡∏Å
- ‡∏´‡∏π‡∏î‡∏°‡∏µ‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏≠‡∏≠‡∏Å‡∏á‡πà‡∏≤‡∏¢ ‡πÇ‡∏ï‡πÄ‡∏£‡πá‡∏ß
- ‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡∏Å‡πâ‡∏≠‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏≠‡∏ß‡∏±‡∏¢‡∏ß‡∏∞‡πÄ‡∏û‡∏®`,
  },

  NormalSkin: {
    info: `‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô ‡∏ú‡∏¥‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥ / ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÇ‡∏£‡∏Ñ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏î‡πà‡∏ô‡∏ä‡∏±‡∏î
‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏°‡∏≤ ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ç‡∏≠‡∏á‡∏™‡∏¥‡∏ß ‡∏ú‡∏∑‡πà‡∏ô‡πÅ‡∏î‡∏á‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á ‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥ ‡∏õ‡∏∑‡πâ‡∏ô‡∏´‡∏ô‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏∏‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏î‡πà‡∏ô‡∏ä‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏Å‡∏±‡∏ö‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ô‡∏ä‡∏∏‡∏î‡∏ô‡∏µ‡πâ
‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏Å‡πá‡∏ï‡∏≤‡∏° ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏ô ‡πÅ‡∏™‡∏ö ‡πÄ‡∏à‡πá‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏≠‡∏¢‡πÇ‡∏£‡∏Ñ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏≠‡∏Å‡∏Å‡∏£‡∏≠‡∏ö‡∏†‡∏≤‡∏û
‡∏´‡∏≤‡∏Å‡∏ú‡∏¥‡∏ß‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏ô ‡πÅ‡∏™‡∏ö ‡∏õ‡∏ß‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡∏≠‡∏á‡∏™‡∏µ / ‡∏£‡∏π‡∏õ‡∏£‡πà‡∏≤‡∏á‡∏ú‡∏∑‡πà‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß ‡∏≠‡∏≤‡∏à‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏õ‡∏Å‡∏ï‡∏¥‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á.`,
    care: `‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏¥‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á
1) ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏ú‡∏¥‡∏ß‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏•‡∏µ‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏™‡∏†‡∏≤‡∏û‡∏ú‡∏¥‡∏ß (‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡πÅ‡∏£‡∏á ‡πÜ ‡πÅ‡∏•‡∏∞‡∏™‡∏ö‡∏π‡πà‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏Ñ‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏∑‡∏≠‡∏á)
2) ‡∏ó‡∏≤‡∏Ñ‡∏£‡∏µ‡∏°‡∏Å‡∏±‡∏ô‡πÅ‡∏î‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ SPF ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô ‡πÅ‡∏°‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡πà‡∏° ‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏£‡∏≠‡∏¢‡∏î‡∏≥ ‡∏ù‡πâ‡∏≤ ‡∏Å‡∏£‡∏∞ ‡πÅ‡∏•‡∏∞‡∏£‡∏¥‡πâ‡∏ß‡∏£‡∏≠‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏±‡∏¢
3) ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏≠‡∏á‡∏Ñ‡∏£‡∏µ‡∏°/‡∏¢‡∏≤‡∏ó‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡πÄ‡∏ï‡∏µ‡∏¢‡∏£‡∏≠‡∏¢‡∏î‡πå‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏£‡∏î‡πÅ‡∏£‡∏á ‡πÜ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
4) ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏¥‡∏ß ‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡∏∑‡πà‡∏ô‡∏ô‡∏π‡∏ô‡πÄ‡∏£‡πá‡∏ß ‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥ ‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ß‡∏á‡∏Å‡∏ß‡πâ‡∏≤‡∏á ‡∏™‡∏µ‡∏Ñ‡∏•‡πâ‡∏≥‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏î‡∏á‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥

‡∏´‡∏≤‡∏Å‡∏ï‡πà‡∏≠‡∏°‡∏≤‡∏°‡∏µ‡∏ú‡∏∑‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà ‡∏Ñ‡∏±‡∏ô‡∏°‡∏≤‡∏Å ‡πÄ‡∏à‡πá‡∏ö ‡∏õ‡∏ß‡∏î‡πÅ‡∏™‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏∑‡πà‡∏ô‡∏•‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß ‡∏Ñ‡∏ß‡∏£‡πÑ‡∏õ‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏ã‡πâ‡∏≥‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á.`,
  },

  Unknown: {
    info: `‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏†‡∏≤‡∏û: ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡πÇ‡∏£‡∏Ñ‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡∏†‡∏≤‡∏û‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÇ‡∏£‡∏Ñ‡∏™‡∏¥‡∏ß ‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏û‡∏≠‡∏á ‡∏≠‡∏µ‡∏™‡∏∏‡∏Å‡∏≠‡∏µ‡πÉ‡∏™ ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö ‡∏™‡∏∞‡πÄ‡∏Å‡πá‡∏î‡πÄ‡∏á‡∏¥‡∏ô ‡∏á‡∏π‡∏™‡∏ß‡∏±‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏π‡∏î
‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ ‡πÄ‡∏ä‡πà‡∏ô
‚Ä¢ ‡∏†‡∏≤‡∏û‡∏ñ‡πà‡∏≤‡∏¢‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î ‡πÉ‡∏Å‡∏•‡πâ/‡πÑ‡∏Å‡∏•‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡πÅ‡∏™‡∏á‡∏ô‡πâ‡∏≠‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏∏‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏£‡∏≠‡∏¢‡πÇ‡∏£‡∏Ñ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
‚Ä¢ ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ú‡∏∑‡πà‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏û‡∏≤‡∏∞ (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡∏°‡πà ‡πÜ)
‚Ä¢ ‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏£‡∏Ñ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏ä‡∏ô‡∏¥‡∏î‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡∏∏‡∏î‡πÇ‡∏£‡∏Ñ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ñ‡∏π‡∏Å‡∏ù‡∏∂‡∏Å‡∏°‡∏≤`,
    care: `‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
1) ‡∏´‡∏≤‡∏Å‡∏ú‡∏∑‡πà‡∏ô/‡∏ï‡∏∏‡πà‡∏°‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏•‡∏≤‡∏°‡∏°‡∏≤‡∏Å ‡∏≠‡∏≤‡∏à‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô 1‚Äì2 ‡∏ß‡∏±‡∏ô
2) ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏≤ ‡πÅ‡∏Å‡∏∞ ‡∏ö‡∏µ‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≤‡∏¢‡∏≤‡πÅ‡∏£‡∏á ‡πÜ ‡πÄ‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡πÄ‡∏ï‡∏µ‡∏¢‡∏£‡∏≠‡∏¢‡∏î‡πå‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å‡πÅ‡∏û‡∏ó‡∏¢‡πå
3) ‡∏´‡∏≤‡∏Å‡∏ú‡∏∑‡πà‡∏ô‡∏•‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß ‡∏õ‡∏ß‡∏î ‡πÅ‡∏™‡∏ö ‡∏£‡πâ‡∏≠‡∏ô ‡∏°‡∏µ‡πÑ‡∏Ç‡πâ‡∏£‡πà‡∏ß‡∏° ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á/‡∏´‡∏ô‡∏≠‡∏á ‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

*‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡πÇ‡∏î‡∏¢‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÑ‡∏î‡πâ‡∏ô‡∏∞‡∏Ñ‡∏∞*`,
  },
};

// mapping entity ‚Üí ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ó‡∏¢‡∏™‡∏±‡πâ‡∏ô ‡πÜ ‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
const diseaseEntityToTh = {
  Acne: "‡∏™‡∏¥‡∏ß",
  Bullous: "‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏û‡∏≠‡∏á",
  Chickenpox: "‡∏≠‡∏µ‡∏™‡∏∏‡∏Å‡∏≠‡∏µ‡πÉ‡∏™",
  Eczema: "‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö",
  Psoriasis: "‡∏™‡∏∞‡πÄ‡∏Å‡πá‡∏î‡πÄ‡∏á‡∏¥‡∏ô",
  Shingles: "‡∏á‡∏π‡∏™‡∏ß‡∏±‡∏î",
  Warts: "‡∏´‡∏π‡∏î",
  NormalSkin: "‡∏ú‡∏¥‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥",
  Unknown: "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏î‡πâ",
};

// ====== Mapping: Thai disease name -> Entity key (‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö Rules sheet) ======
const diseaseThToEntity = {
  "‡∏™‡∏¥‡∏ß": "Acne",
  "‡∏™‡∏¥‡∏ß‡∏≠‡∏∏‡∏î‡∏ï‡∏±‡∏ô": "Acne",
  "‡∏™‡∏¥‡∏ß‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö": "Acne",

  "‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏û‡∏≠‡∏á": "Bullous",
  "‡∏ï‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏û‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô": "Bullous",

  "‡∏≠‡∏µ‡∏™‡∏∏‡∏Å‡∏≠‡∏µ‡πÉ‡∏™": "Chickenpox",
  "‡∏™‡∏∏‡∏Å‡πÉ‡∏™": "Chickenpox",

  "‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö": "Eczema",
  "‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡∏µ‡∏°‡∏≤": "Eczema",
  "‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡∏µ‡∏°‡∏≤": "Eczema",

  "‡∏™‡∏∞‡πÄ‡∏Å‡πá‡∏î‡πÄ‡∏á‡∏¥‡∏ô": "Psoriasis",

  "‡∏á‡∏π‡∏™‡∏ß‡∏±‡∏î": "Shingles",

  "‡∏´‡∏π‡∏î": "Warts",
  "‡∏´‡∏π‡∏î‡∏ù‡πà‡∏≤‡πÄ‡∏ó‡πâ‡∏≤": "Warts",

  "‡∏ú‡∏¥‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥": "NormalSkin",
  "‡∏ú‡∏¥‡∏ß‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏£‡∏Ñ": "NormalSkin",

  "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏î‡πâ": "Unknown",
  "‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö": "Unknown",
};

// ===== URL ‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÄ‡∏°‡∏ô‡∏π C / E =====
const IMAGE_MANUAL_URL =
  process.env.IMAGE_MANUAL_URL || "https://drive.google.com/file/d/1w0jWsKehSFiSGTq59sPzkWcChBbMwyQT/view?usp=sharing";
const IMAGE_TREND_URL =
  process.env.IMAGE_TREND_URL || "https://drive.google.com/file/d/15dvR47R8pfAj5ToJ2ehGDULKnEs2H9W8/view?usp=sharing";

// ====== ‡πÇ‡∏´‡∏•‡∏î labels + model ======
const MODEL_DIR = path.join(__dirname, "model");
const MODEL_PATH = `file://${path.join(MODEL_DIR, "model.json")}`;
const LABELS_PATH = path.join(__dirname, "class_names.json");

let labels = [];
try {
  labels = JSON.parse(fs.readFileSync(LABELS_PATH, "utf-8"));
  if (!Array.isArray(labels) || labels.length < 2) throw new Error("labels invalid");
  console.log("‚úÖ Loaded labels:", labels);
} catch (e) {
  console.error("‚ùå Load labels failed:", e.message);
  labels = ["ClassA", "ClassB", "Unknown"];
}

let model = null;
let modelReady = false;
let modelType = "unknown";

(async () => {
  try {
    try {
      model = await tf.loadGraphModel(MODEL_PATH);
      modelType = "graph";
      modelReady = true;
      console.log("‚úÖ TFJS GraphModel loaded");
    } catch {
      model = await tf.loadLayersModel(MODEL_PATH);
      modelType = "layers";
      modelReady = true;
      console.log("‚úÖ TFJS LayersModel loaded");
    }
  } catch (err) {
    console.error("‚ùå Failed to load model:", err);
  }
})();

app.use(bodyParser.json());

// ===== Helper: ‡∏ï‡∏≠‡∏ö LINE =====
async function replyMessage(replyToken, messages) {
  const msgs = Array.isArray(messages) ? messages : [{ type: "text", text: String(messages) }];

  try {
    await axios.post(
      "https://api.line.me/v2/bot/message/reply",
      { replyToken, messages: msgs },
      {
        headers: { Authorization: `Bearer ${LINE_ACCESS_TOKEN}` },
        timeout: 15000,
      }
    );
  } catch (e) {
    console.error("Reply error:", e?.response?.data || e.message);
  }
}

// ===== Utils =====
function entropy(ps) {
  let h = 0;
  for (const p of ps) if (p > 0) h -= p * Math.log(p);
  return h;
}
function top2(ps) {
  let b = [-1, -1],
    s = [-1, -1];
  for (let i = 0; i < ps.length; i++) {
    const p = ps[i];
    if (p > b[1]) {
      s = b;
      b = [i, p];
    } else if (p > s[1]) {
      s = [i, p];
    }
  }
  return { bestIdx: b[0], bestProb: b[1], secondIdx: s[0], secondProb: s[1] };
}
function softmax(arr) {
  const m = Math.max(...arr);
  const exps = arr.map((v) => Math.exp(v - m));
  const s = exps.reduce((a, b) => a + b, 0);
  return exps.map((v) => v / s);
}
function sharpenProbs(probs, gamma) {
  const raised = probs.map((p) => Math.pow(Math.max(p, 1e-12), gamma));
  const s = raised.reduce((a, b) => a + b, 0);
  return raised.map((v) => v / s);
}

// ===== Core: classify =====
async function classifyImage(imageBuffer, { debug = false } = {}) {
  if (!modelReady) throw new Error("Model not ready");

  let pre;
  try {
    pre = await sharp(imageBuffer, { limitInputPixels: false })
      .rotate()
      .ensureAlpha()
      .removeAlpha()
      .resize(INPUT_SIZE, INPUT_SIZE, { fit: "cover" })
      .toFormat("png")
      .toBuffer();
  } catch (e) {
    throw new Error("IMAGE_PREPROCESS_FAIL: " + e.message);
  }

  let x = tf.node.decodeImage(pre, 3).toFloat().expandDims(0);
  if (!MODEL_INCLUDES_RESCALE) x = x.div(255);

  let y = null;
  try {
    y = model.predict ? model.predict(x) : null;
    if (Array.isArray(y)) y = y[0];
    if (!y || typeof y.dataSync !== "function") {
      const feedName = model.inputs?.[0]?.name;
      const fetchName = model.outputs?.[0]?.name;
      y = model.execute(feedName ? { [feedName]: x } : x, fetchName);
    }
  } catch (e) {
    tf.dispose(x);
    throw new Error("MODEL_EXEC_FAIL: " + e.message);
  }

  let probs;
  try {
    const raw = Array.from(y.dataSync());
    const sum = raw.reduce((p, c) => p + c, 0);
    probs = Math.abs(sum - 1) > 1e-3 ? softmax(raw) : raw;

    const nameByIdx = labels;
    const weighted = probs.map((p, i) => {
      const name = nameByIdx[i] || "";
      const w = CALIB_WEIGHTS[name] || 1.0;
      return p * w;
    });
    const s = weighted.reduce((a, b) => a + b, 0);
    probs = weighted.map((v) => v / (s || 1));

    probs = sharpenProbs(probs, PROB_SHARPEN_GAMMA);
  } catch (e) {
    tf.dispose([x, y]);
    throw new Error("POSTPROCESS_FAIL: " + e.message);
  }

  const { bestIdx, bestProb, secondProb } = top2(probs);
  const bestName = labels[bestIdx] || "Unknown";
  const ent = entropy(probs);

  const perClassTh = PER_CLASS_THRESHOLDS[bestName];

  const isUnknown =
    bestProb < (perClassTh ?? UNKNOWN_THRESHOLD) ||
    bestProb - secondProb < MARGIN_THRESHOLD ||
    ent > ENTROPY_THRESHOLD;

  const idx = isUnknown ? labels.length - 1 : bestIdx;
  const label = labels[idx] || "Unknown";
  const score = Number((bestProb * 100).toFixed(2));

  if (debug) {
    const top3 = [...probs]
      .map((p, i) => ({ i, p }))
      .sort((a, b) => b.p - a.p)
      .slice(0, 3)
      .map((o) => `${labels[o.i]}:${(o.p * 100).toFixed(1)}%`)
      .join(", ");
    console.log(
      `[DEBUG] top3 = ${top3} | H=${ent.toFixed(3)} | margin=${(bestProb - secondProb).toFixed(
        3
      )}`
    );
  }

  tf.dispose([x, y]);
  return { label, score, appliedUnknown: isUnknown };
}

// ===== Dialogflow Setup =====
const DIALOGFLOW_PROJECT_ID = process.env.DIALOGFLOW_PROJECT_ID;
let dfSessionsClient = null;

if (DIALOGFLOW_PROJECT_ID) {
  // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ GOOGLE_CREDS_JSON ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô credentials
  const dfOptions = {};
  if (process.env.GOOGLE_CREDS_JSON) {
    dfOptions.credentials = JSON.parse(process.env.GOOGLE_CREDS_JSON);
  }

  dfSessionsClient = new dialogflow.SessionsClient(dfOptions);
}


async function detectIntent(sessionId, text) {
  if (!dfSessionsClient || !DIALOGFLOW_PROJECT_ID) {
    throw new Error("Dialogflow not configured");
  }
  const sessionPath = dfSessionsClient.projectAgentSessionPath(DIALOGFLOW_PROJECT_ID, sessionId);

  const request = {
    session: sessionPath,
    queryInput: {
      text: {
        text,
        languageCode: "th",
      },
    },
  };

  const [response] = await dfSessionsClient.detectIntent(request);
  return response.queryResult;
}

// ===== Google Sheets Setup =====
const QUESTIONS_SHEET_ID = process.env.QUESTIONS_SHEET_ID || process.env.SHEETS_ID;
const QUESTIONS_RANGE = process.env.QUESTIONS_RANGE || "derma_questions!A1:Z1000";

const RULES_SHEET_ID = process.env.RULES_SHEET_ID || process.env.RULES_ID;
const RULES_RANGE = process.env.RULES_RANGE || "rules!A1:D500";

let sheetsApi = null;
async function getSheetsApi() {
  if (sheetsApi) return sheetsApi;
  const auth = new google.auth.GoogleAuth({
  credentials: JSON.parse(process.env.GOOGLE_CREDS_JSON),
  scopes: ["https://www.googleapis.com/auth/spreadsheets.readonly"],
});
  sheetsApi = google.sheets({ version: "v4", auth });
  return sheetsApi;
}

// ===== Quiz: ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° =====
let questionsCache = null;

async function loadQuestions() {
  if (questionsCache) return questionsCache;
  if (!QUESTIONS_SHEET_ID) throw new Error("QUESTIONS_SHEET_ID not set");

  const sheets = await getSheetsApi();
  const res = await sheets.spreadsheets.values.get({
    spreadsheetId: QUESTIONS_SHEET_ID,
    range: QUESTIONS_RANGE,
  });

  const rows = res.data.values || [];
  if (!rows.length) {
    questionsCache = [];
    return questionsCache;
  }

  const dataRows = rows.slice(1); // ‡∏Ç‡πâ‡∏≤‡∏° header

  // header: qid | question_th | type | options (A|B|C|...)
  questionsCache = dataRows
    .filter((r) => r[0] && r[1])
    .map((r) => {
      const qid = r[0];
      const question = r[1];
      const type = r[2] || "choice";
      const optionsRaw = r[3] || "";
      const options = String(optionsRaw)
        .split("|")
        .map((s) => s.trim())
        .filter((s) => s);
      return { qid, question, type, options };
    });

  console.log("‚úÖ Loaded questions:", questionsCache.length);
  return questionsCache;
}

// ===== Rules: ‡πÇ‡∏´‡∏•‡∏î qid | option_th | disease_th | score =====
let rulesCache = null;

async function loadRules() {
  if (rulesCache) return rulesCache;
  if (!RULES_SHEET_ID) throw new Error("RULES_SHEET_ID not set");

  const sheets = await getSheetsApi();
  const res = await sheets.spreadsheets.values.get({
    spreadsheetId: RULES_SHEET_ID,
    range: RULES_RANGE,
  });

  const rows = res.data.values || [];
  if (!rows.length) {
    rulesCache = [];
    return rulesCache;
  }

  const dataRows = rows.slice(1); // ‡∏Ç‡πâ‡∏≤‡∏° header

  rulesCache = dataRows
    .filter((r) => r[0] && r[1] && r[2])
    .map((r) => ({
      qid: r[0],
      option_th: r[1],
      disease_th: r[2],
      score: Number(r[3] || 0),
    }));

  console.log("‚úÖ Loaded rules (rows):", rulesCache.length);
  return rulesCache;
}

// ===== ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏£‡∏Ñ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö quiz ‡∏ï‡∏≤‡∏° rules =====
async function calculateDiseaseFromRules(answers) {
  const rules = await loadRules();

  const diseaseEntities = [
    "Acne",
    "Bullous",
    "Chickenpox",
    "Eczema",
    "Psoriasis",
    "Shingles",
    "Warts",
    "NormalSkin",
    "Unknown",
  ];

  const scores = {};
  diseaseEntities.forEach((k) => {
    scores[k] = 0;
  });

  for (const rule of rules) {
    const ans = answers[rule.qid];
    if (!ans) continue;

    if (String(ans.optionText).trim() === String(rule.option_th).trim()) {
      const entityKey = diseaseThToEntity[rule.disease_th] || "Unknown";
      const addScore = Number(rule.score || 0);
      scores[entityKey] += addScore;
    }
  }

  let bestDiseaseEntity = "Unknown";
  let bestScore = 0;
  for (const d of diseaseEntities) {
    if (scores[d] > bestScore) {
      bestScore = scores[d];
      bestDiseaseEntity = d;
    }
  }

  if (bestScore <= 0) bestDiseaseEntity = "Unknown";

  return { bestDiseaseEntity, scores, bestScore };
}

// ===== Quiz state per user =====
const quizState = new Map();

// quick reply ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠
function buildQuestionMessages(qIndex, total, q) {
  const header = `‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${qIndex + 1}/${total}\n${q.question}`;
  const quickItems = q.options.map((opt, i) => ({
    type: "action",
    action: {
      type: "message",
      label: `${i + 1}) ${opt}`,
      text: `${i + 1}`, // ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏á‡πÄ‡∏•‡∏Ç‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
    },
  }));

  return [
    {
      type: "text",
      text: header,
      quickReply: {
        items: quickItems,
      },
    },
  ];
}

async function startQuizForUser(userId, replyToken) {
  const questions = await loadQuestions();
  if (!questions.length) {
    await replyMessage(replyToken, "‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡πà‡∏∞");
    return;
  }

  quizState.set(userId, {
    inProgress: true,
    currentIndex: 0,
    questions,
    answers: {},
  });

  const firstQ = questions[0];
  await replyMessage(replyToken, buildQuestionMessages(0, questions.length, firstQ));
}

async function handleQuizAnswer(userId, replyToken, userText) {
  const state = quizState.get(userId);
  if (!state || !state.inProgress) {
    await replyMessage(
      replyToken,
      '‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ß‡πà‡∏≤ "‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á" ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏Ñ‡πà‡∏∞ üòä'
    );
    return;
  }

  const q = state.questions[state.currentIndex];
  const total = state.questions.length;

  const num = parseInt(userText.trim(), 10);
  if (Number.isNaN(num) || num < 1 || num > q.options.length) {
    const msgs = buildQuestionMessages(state.currentIndex, total, q);
    msgs[0].text = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏∞‡∏Ñ‡∏∞ üòä\n\n" + msgs[0].text;
    await replyMessage(replyToken, msgs);
    return;
  }

  const idx = num - 1;
  const optionText = q.options[idx];

  state.answers[q.qid] = { optionIndex: idx, optionText };

  if (state.currentIndex + 1 < total) {
    state.currentIndex += 1;
    const nextQ = state.questions[state.currentIndex];
    await replyMessage(replyToken, buildQuestionMessages(state.currentIndex, total, nextQ));
  } else {
    state.inProgress = false;

    const { bestDiseaseEntity, bestScore } = await calculateDiseaseFromRules(state.answers);

    const thName = diseaseEntityToTh[bestDiseaseEntity] || bestDiseaseEntity;
    const infoObj = diseaseInfo[bestDiseaseEntity] || diseaseInfo.Unknown;

    await replyMessage(replyToken, [
      {
        type: "text",
        text:
          `‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏à‡∏≤‡∏Å‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô 15 ‡∏Ç‡πâ‡∏≠\n` +
          `‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Å‡∏±‡∏ö: ${thName}\n(‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: ${bestScore})`,
      },
      { type: "text", text: infoObj.info },
      { type: "text", text: infoObj.care },
      { type: "text", text: DISCLAIMER },
    ]);
  }
}

// ===== LINE Webhook =====
app.post("/webhook", async (req, res) => {
  const events = req.body?.events || [];
  for (const event of events) {
    const replyToken = event.replyToken;
    const userId = event.source?.userId || "unknown-user";

    try {
      if (event.type === "message") {
        // ==== IMAGE ====
        if (event.message.type === "image") {
          if (!modelReady) {
            await replyMessage(replyToken, "‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏≠‡∏¢‡∏π‡πà ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô‡πÑ‡∏°‡πà‡∏Å‡∏µ‡πà‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏Ñ‡πà‡∏∞");
            continue;
          }

          let imgBuf;
          try {
            const r = await axios.get(
              `https://api-data.line.me/v2/bot/message/${event.message.id}/content`,
              {
                headers: {
                  Authorization: `Bearer ${LINE_ACCESS_TOKEN}`,
                },
                responseType: "arraybuffer",
                timeout: 30000,
                maxContentLength: Infinity,
                maxBodyLength: Infinity,
              }
            );
            imgBuf = Buffer.from(r.data);
          } catch (e) {
            console.error("Fetch image error:", e?.response?.status || e.message);
            await replyMessage(
              replyToken,
              "‡∏î‡∏∂‡∏á‡∏£‡∏π‡∏õ‡∏à‡∏≤‡∏Å LINE ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏•‡∏≠‡∏á‡∏™‡πà‡∏á‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô JPG/PNG ‡∏î‡∏π‡∏ô‡∏∞‡∏Ñ‡∏∞"
            );
            continue;
          }

          try {
            const { label, score, appliedUnknown } = await classifyImage(imgBuf, {
              debug: false,
            });

            const diseaseKey = diseaseInfo[label]
              ? label
              : label === "NormalSkin"
              ? "NormalSkin"
              : "Unknown";

            const thName = diseaseEntityToTh[diseaseKey] || diseaseKey;
            const infoObj = diseaseInfo[diseaseKey] || diseaseInfo.Unknown;

            const extra = appliedUnknown ? " (‡∏à‡∏±‡∏î‡πÄ‡∏õ‡πá‡∏ô Unknown/‡πÑ‡∏°‡πà‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à)" : "";

            await replyMessage(replyToken, [
              {
                type: "text",
                text:
                  `‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û:\n` +
                  `‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô: ${thName}${extra}\n` +
                  `‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏• (class ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î) ‚âà ${score.toFixed(1)}%`,
              },
              { type: "text", text: infoObj.info },
              { type: "text", text: infoObj.care },
              { type: "text", text: DISCLAIMER },
            ]);
          } catch (e) {
            console.error("Classify error:", e.message);
            await replyMessage(
              replyToken,
              "‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏∞ (‡∏•‡∏≠‡∏á‡∏™‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô JPG/PNG ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ)"
            );
          }

          continue;
        }

        // ==== TEXT ====
        if (event.message.type === "text") {
          const text = event.message.text.trim();

          // 1) ‡∏õ‡∏∏‡πà‡∏° Rich menu ‡∏Å‡πà‡∏≠‡∏ô (‡∏Å‡∏±‡∏ô‡∏ä‡∏ô Dialogflow)
          if (text === "‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô" || text === "‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ Dermalyze") {
            await replyMessage(replyToken, {
              type: "image",
              originalContentUrl: IMAGE_MANUAL_URL,
              previewImageUrl: IMAGE_MANUAL_URL,
            });
            continue;
          }

          if (text === "‡πÇ‡∏£‡∏Ñ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏∞‡∏ö‡∏≤‡∏î" || text === "‡πÇ‡∏£‡∏Ñ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏∞‡∏ö‡∏≤‡∏î") {
            await replyMessage(replyToken, {
              type: "image",
              originalContentUrl: IMAGE_TREND_URL,
              previewImageUrl: IMAGE_TREND_URL,
            });
            continue;
          }

          // 2) ‡πÄ‡∏£‡∏¥‡πà‡∏° quiz ‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π A
          if (
            text === "‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏∑‡πà‡∏ô‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏ô‡∏∞‡∏Ñ‡∏∞" ||
            text === "‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô" ||
            text === "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á" ||
            text === "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏∑‡πà‡∏ô‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á"
          ) {
            await startQuizForUser(userId, replyToken);
            continue;
          }

          // 3) ‡∏ñ‡πâ‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥ quiz ‡∏≠‡∏¢‡∏π‡πà ‚Üí ‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö (‡πÄ‡∏•‡∏Ç‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏° quick reply)
          const state = quizState.get(userId);
          if (state && state.inProgress) {
            await handleQuizAnswer(userId, replyToken, text);
            continue;
          }

          // 4) ‡∏ñ‡∏≤‡∏°‡∏ï‡∏≠‡∏ö‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ‚Üí ‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ Dialogflow
          try {
            const result = await detectIntent(userId, text);
            const params = result.parameters?.fields || {};

            let diseaseParam = "";
            let askType = "both"; // ‡∏Ñ‡πà‡∏≤ default

            if (params.disease) {
              diseaseParam = params.disease.stringValue || "";
            }
            if (params.ask_type) {
              askType = params.ask_type.stringValue || "both";
            }

            if (diseaseParam && diseaseInfo[diseaseParam]) {
              const thName = diseaseEntityToTh[diseaseParam] || diseaseParam;
              const infoObj = diseaseInfo[diseaseParam];

              const msgs = [
                { type: "text", text: `‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö: ${thName}` },
              ];

              // ‡∏™‡πà‡∏á info ‡∏ï‡∏≤‡∏° askType
              if (askType === "info" || askType === "both") {
                msgs.push({ type: "text", text: infoObj.info });
              }

              // ‡∏™‡πà‡∏á care ‡∏ï‡∏≤‡∏° askType
              if (askType === "care" || askType === "both") {
                msgs.push({ type: "text", text: infoObj.care });
              }

              // ‡∏õ‡∏¥‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ DISCLAIMER ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÇ‡∏£‡∏Ñ
              msgs.push({ type: "text", text: DISCLAIMER });

              await replyMessage(replyToken, msgs);
            } else {
              const fallback =
                result.fulfillmentText ||
                "‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏£‡∏π‡∏õ‡∏ú‡∏∑‡πà‡∏ô‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÇ‡∏£‡∏Ñ‡∏™‡∏¥‡∏ß ‡∏ú‡∏∑‡πà‡∏ô ‡∏•‡∏°‡∏û‡∏¥‡∏© ‡∏á‡∏π‡∏™‡∏ß‡∏±‡∏î ‡∏Ø‡∏•‡∏Ø ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞";
              await replyMessage(replyToken, fallback);
            }
          } catch (e) {
            console.error("Dialogflow error:", e.message);
            await replyMessage(
              replyToken,
              "‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÑ‡∏î‡πâ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏™‡πà‡∏á‡∏£‡∏π‡∏õ‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ‡∏ô‡∏∞‡∏Ñ‡∏∞"
            );
          }

          continue;
        }

        // type message ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ
        await replyMessage(replyToken, "‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ô‡∏∞‡∏Ñ‡∏∞");
      } else {
        await replyMessage(replyToken, "‡∏¢‡∏±‡∏á‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ô‡∏∞‡∏Ñ‡∏∞");
      }
    } catch (err) {
      console.error("Webhook error:", err?.response?.data || err.message);
      await replyMessage(replyToken, "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏∞");
    }
  }

  res.sendStatus(200);
});

// ===== Health & Debug =====
app.get("/", (_req, res) => res.send("Webhook is working!"));
app.get("/healthz", (_req, res) =>
  res.json({
    ok: true,
    modelReady,
    modelType,
    nLabels: labels.length,
    thresholds: {
      UNKNOWN_THRESHOLD,
      MARGIN_THRESHOLD,
      ENTROPY_THRESHOLD,
      PROB_SHARPEN_GAMMA,
      CALIB_WEIGHTS,
      PER_CLASS_THRESHOLDS,
    },
  })
);

app.post(
  "/debug/classify",
  express.raw({ type: "*/*", limit: "10mb" }),
  async (req, res) => {
    try {
      const out = await classifyImage(req.body, {
        debug: true,
      });
      res.json(out);
    } catch (e) {
      res.status(500).json({ error: e.message });
    }
  }
);

app.listen(PORT, () => console.log(`üöÄ Server running on port ${PORT}`));
